<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xm.service.dao.cim.DwrEquipmentThroughputFidsDAO" >

    <select id="queryThroughputData" resultType="com.xm.service.apiimpl.pc.cim.equipmentstatus.dto.EquipmentThroughputData" parameterType="Map">
        select
            FACTORY as factory,
            TO_CHAR(DATADATE,'HH24')||':00' as dataDate,
            avg(AMOUNT) as amount
        from DWR_EQUIPMENT_THROUGHPUT_FIDS
        WHERE
            <![CDATA[
               DATADATE >= #{beginDate}
               and DATADATE <= #{endDate}
            ]]>
            <if test="factory!=null and factory!=''">
                AND FACTORY=#{factory,jdbcType=VARCHAR}
            </if>
        GROUP BY
            FACTORY,TO_CHAR(DATADATE,'HH24')||':00'
    </select>

</mapper>