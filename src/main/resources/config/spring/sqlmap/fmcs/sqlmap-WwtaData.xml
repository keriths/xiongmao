<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xm.service.dao.fmcs.WwtaDataDAO" >

    <select id="queryWwtaDataList" resultType="com.xm.service.apiimpl.pc.fmcs.wwt.dto.WwtaData" parameterType="Map">
        SELECT
            KEY AS key,
            VALUE AS value,
            KEYDESC AS keyDesc,
            DATADATE AS dataDate,
            DATATYPE AS dataType,
            DEMODATA AS demoData,
            UNIT as unit
        FROM WWTADATA a
            join (
              select key as keyb,max(DATADATE) as DATADATEb from WWTADATA
               WHERE VALUE is not null and VALUE != '-2147483648'
               group by key )
            b on  a.key = b.keyb and a.DATADATE = b.DATADATEb
            WHERE VALUE is not null and VALUE != '-2147483648'
    </select>


</mapper>