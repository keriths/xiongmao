<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xm.service.dao.cim.PanelSalesIncomeCostDAO">

    <select id="getPanelSalesIncomeCostData" parameterType="map"
            resultType="com.xm.service.apiimpl.pc.sap.PanelSalesIncomeAndCost.dto.PanelSalesIncomeCostData">
        select * from ET_SRCB_REP
        WHERE YEAR = #{Year} and MONTH = #{Month} and CPBM = #{CPBM}
    </select>

    <select id="getPanelSalesIncomeCostDataByYear" parameterType="map"
            resultType="com.xm.service.apiimpl.pc.sap.PanelSalesIncomeAndCost.dto.PanelSalesIncomeCostData">
        select * from ET_SRCB_REP
        WHERE YEAR = #{Year}
    </select>

    <select id="getPanelSalesIncomeCostDataByYearAndMonth" parameterType="map"
            resultType="com.xm.service.apiimpl.pc.sap.PanelSalesIncomeAndCost.dto.PanelSalesIncomeCostData">
        select * from ET_SRCB_REP
        WHERE YEAR = #{Year} and MONTH = #{Month}
    </select>

    <select id="getPanelSalesIncomeCostYearDataByYear" parameterType="map"
            resultType="com.xm.service.apiimpl.pc.sap.PanelSalesIncomeAndCost.dto.PanelSalesIncomeCostData">
        <![CDATA[
        select * from (
        select
        YEARã€€as YEAR,
        MONTH as MONTH,
        SUM(DDL01) as DDL01,
        SUM(DDL02) as DDL02,
        SUM(DDE01) as DDE01,
        SUM(DDE02) as DDE02,
        SUM(XSL01) as XSL01,
        SUM(XSL02) as XSL02,
        SUM(XSL03) as XSL03,
        SUM(XSL04) as XSL04,
        SUM(CKL01) as CKL01,
        SUM(CKL02) as CKL02,
        SUM(KCL01) as KCL01,
        SUM(KCL02) as KCL02,
        SUM(KCL03) as KCL03,
        SUM(KCL04) as KCL04,
        SUM(KCZE01) as KCZE01,
        SUM(KCZE02) as KCZE02,
        SUM(XSSR01) as XSSR01,
        SUM(XSSR02) as XSSR02,
        SUM(CCL01) as CCL01,
        SUM(CKSR01) as CKSR01,
        SUM(CKSR02) as CKSR02
        from ET_SRCB_REP
        GROUP BY (YEAR,MONTH)
         ORDER BY YEAR,MONTH DESC
        ) T
        WHERE rownum <= 12
         ]]>
    </select>

    <insert id="addData" parameterType="map">
        INSERT INTO ET_SRCB_REP
        (
        YEAR, MONTH, CPBM, DDL01, DDL02, DDE01, DDE02, XSL01, XSL02, XSL03, XSL04, CKL01, CKL02, KCL01,KCL02, KCL03,
        KCL04, KCZE01, KCZE02, XSSR01, XSSR02, CCL01, CKSR01, CKSR02
        ) VALUES
        (
        #{Year,jdbcType=VARCHAR},
        #{Month,jdbcType=VARCHAR},
        #{cpbm,jdbcType=CHAR},
        #{ddl01,jdbcType=DECIMAL},
        #{ddl02,jdbcType=DECIMAL},
        #{dde01,jdbcType=DECIMAL},
        #{dde02,jdbcType=DECIMAL},
        #{xsl01,jdbcType=DECIMAL},
        #{xsl02,jdbcType=DECIMAL},
        #{xsl03,jdbcType=DECIMAL},
        #{xsl04,jdbcType=DECIMAL},
        #{ckl01,jdbcType=DECIMAL},
        #{ckl02,jdbcType=DECIMAL},
        #{kcl01,jdbcType=DECIMAL},
        #{kcl02,jdbcType=DECIMAL},
        #{kcl03,jdbcType=DECIMAL},
        #{kcl04,jdbcType=DECIMAL},
        #{kcze01,jdbcType=DECIMAL},
        #{kcze02,jdbcType=DECIMAL},
        #{xssr01,jdbcType=DECIMAL},
        #{xssr02,jdbcType=DECIMAL},
        #{ccl01,jdbcType=DECIMAL},
        #{cksr01,jdbcType=DECIMAL},
        #{cksr02,jdbcType=DECIMAL}
        )
    </insert>
    <update id="updateData" parameterType="map">
        UPDATE ET_SRCB_REP SET
        DDL01= #{ddl01,jdbcType=DECIMAL},
        DDL02= #{ddl02,jdbcType=DECIMAL},
        DDE01= #{dde01,jdbcType=DECIMAL},
        DDE02= #{dde02,jdbcType=DECIMAL},
        XSL01= #{xsl01,jdbcType=DECIMAL},
        XSL02= #{xsl02,jdbcType=DECIMAL},
        XSL03= #{xsl03,jdbcType=DECIMAL},
        XSL04= #{xsl04,jdbcType=DECIMAL},
        CKL01= #{ckl01,jdbcType=DECIMAL},
        CKL02= #{ckl02,jdbcType=DECIMAL},
        KCL01= #{kcl01,jdbcType=DECIMAL},
        KCL02= #{kcl02,jdbcType=DECIMAL},
        KCL03= #{kcl03,jdbcType=DECIMAL},
        KCL04= #{kcl04,jdbcType=DECIMAL},
        KCZE01= #{kcze01,jdbcType=DECIMAL},
        KCZE02= #{kcze02,jdbcType=DECIMAL},
        XSSR01= #{xssr01,jdbcType=DECIMAL},
        XSSR02= #{xssr02,jdbcType=DECIMAL},
        CCL01= #{ccl01,jdbcType=DECIMAL},
        CKSR01= #{cksr01,jdbcType=DECIMAL},
        CKSR02= #{cksr02,jdbcType=DECIMAL}

        WHERE
        YEAR = #{Year,jdbcType=VARCHAR} and
        MONTH = #{Month,jdbcType=VARCHAR} and
        CPBM= #{cpbm,jdbcType=CHAR}
    </update>
    <select id="getOneData" parameterType="map" resultType="map">
        select *
        from ET_SRCB_REP
        WHERE  YEAR = #{Year} and MONTH = #{Month} and CPBM = #{CPBM}
    </select>
</mapper>