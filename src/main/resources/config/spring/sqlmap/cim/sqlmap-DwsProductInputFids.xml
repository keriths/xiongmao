<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xm.service.dao.cim.DwsProductInputFidsDAO" >
    <select id="queryInputInfo" resultType="com.xm.service.apiimpl.pc.cim.inputCompletion.dto.InputCompletionRetDTO$InputCompletionData" parameterType="map">
        select
            sum(PLAN_INPUT_GLS_QTY) as plan,
            sum(ACTUAL_INPUT_GLS_QTY) as actual,
            <if test="dateType=='day'.toString()">
                to_char(PERIODDATE,'MM/DD')
            </if>
            <if test="dateType=='month'.toString()">
                to_char(PERIODDATE,'MM') ||'月'
            </if>
            <if test="dateType=='quarter'.toString()">
                to_char(PERIODDATE,'q') ||'季度'
            </if>
            as dateTime
        from
            DWS_PRODUCT_INPUT_FIDS
        where
            <![CDATA[
            PERIODDATE >= #{beginDate}
            and PERIODDATE <= #{endDate}
            ]]>
            <if test=" productId!=null ">
                and PRODUCTID = #{productId}
            </if>
        group by
            <if test="dateType=='day'.toString()">
                to_char(PERIODDATE,'MM/DD')
            </if>
            <if test="dateType=='month'.toString()">
                to_char(PERIODDATE,'MM') ||'月'
            </if>
            <if test="dateType=='quarter'.toString()">
                to_char(PERIODDATE,'q') ||'季度'
            </if>
    </select>
</mapper>