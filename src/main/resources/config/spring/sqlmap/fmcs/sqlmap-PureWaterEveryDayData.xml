<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xm.service.dao.fmcs.PureWaterEveryDayDataDAO" >

    <!--<select id="pureWaterEveryDayData" resultType="com.xm.service.apiimpl.pc.fmcs.water.dto.PureWaterEveryDayData" parameterType="Map">-->
        <!--SELECT-->
            <!--SUM(TotalNum) as totalNum,-->
            <!--<if test="dateType=='month'.toString()">/*按月*/-->
                <!--TO_CHAR(DataDate,'MM')||'月'-->
            <!--</if>-->
            <!--<if test="dateType=='day'.toString()">/*按天*/-->
                <!--TO_CHAR(DataDate,'mm/dd')-->
            <!--</if>-->
            <!--as dataDate-->
        <!--FROM PureWaterEveryDayData-->
        <!--WHERE-->
            <!--<![CDATA[-->
                <!--DataDate >= #{beginDate}-->
                <!--and DataDate <= #{endDate}-->
            <!--]]>-->
            <!--<if test="waterType!=null and waterType!=''">-->
                <!--AND Type=#{waterType,jdbcType=VARCHAR}-->
            <!--</if>-->
        <!--GROUP BY-->
            <!--<if test="dateType=='month'.toString()">/*按月*/-->
                <!--TO_CHAR(DataDate,'MM')||'月'-->
            <!--</if>-->
            <!--<if test="dateType=='day'.toString()">-->
                <!--TO_CHAR(DataDate,'mm/dd')-->
            <!--</if>-->
    <!--</select>-->



    <!--<select id="queryPureWaterByDate" parameterType="map" resultType="com.xm.service.apiimpl.pc.integrateData.humidity.dto.WaterElectricityCollectDataDTO$WaterElectricityCollectData">-->
        <!--SELECT-->
        <!--sum(TOTALNUM) as totalNum-->
        <!--FROM-->
        <!--PUREWATEREVERYDAYDATA-->
        <!--WHERE-->
        <!--<![CDATA[-->
          <!--DATADATE >= #{startDate}-->
          <!--and DATADATE <= #{endDate}-->
        <!--]]>-->
        <!--and TotalNum is not null-->
        <!--and TotalNum != -2147483648-->
    <!--</select>-->

    <select id="queryTwoDaysPureWaterByQueryData"  parameterType="map" resultType="com.xm.service.dto.TwoDaysDataDTO">
        SELECT
        beforTotalNum,
        beforDataDate,
        afterTotalNum,
        afterDataDate
        FROM (
        SELECT
        sum(TOTALNUM) as beforTotalNum,DATADATE as beforDataDate
        FROM
        PUREWATEREVERYDAYDATA
        WHERE DATADATE = #{beforDate,jdbcType=DATE}
        and TotalNum is not null
        and TotalNum != -2147483648
        group by DATADATE
        ) a
        join (
        SELECT
        sum(TOTALNUM) as afterTotalNum,DATADATE as afterDataDate
        FROM
        PUREWATEREVERYDAYDATA
        WHERE DATADATE = #{afterDate,jdbcType=DATE}
        and TotalNum is not null
        and TotalNum != -2147483648
        group by DATADATE
        ) b on 1=1
    </select>

    <select id="queryDayDataByDateList" parameterType="map" resultType="com.xm.service.dto.DayDataDTO">
        SELECT TOTALNUM as totalNum,DATADATE as dataDate
        FROM PUREWATEREVERYDAYDATA
        WHERE Type=#{waterType,jdbcType=VARCHAR}
        AND DATADATE IN
        <foreach collection="queryDateList" item="queryDate" open="(" separator="," close=")">
            #{queryDate,jdbcType=DATE}
        </foreach>
        and TotalNum is not null
        and TotalNum != -2147483648
    </select>

</mapper>